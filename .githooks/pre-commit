#!/usr/bin/env sh
set -eu

# Format and lint Deno source
printf "[pre-commit] Checking format...\n"
deno fmt --check || { printf "Format check failed.\n"; exit 1; }

printf "[pre-commit] Running Deno lint...\n"
deno lint || { printf "Lint failed.\n"; exit 1; }

# Run Deno tests (quick unit tests)
printf "[pre-commit] Running Deno tests...\n"
deno task test:deno || { printf "Deno tests failed.\n"; exit 1; }

# Run Vitest test suite via Deno npm bridge
# Vitest disabled; only Deno tests are run

printf "[pre-commit] All checks passed.\n"
